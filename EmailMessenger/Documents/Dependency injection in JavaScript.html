<!DOCTYPE html>
<!-- saved from url=(0073)http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
		
		<meta name="y_key" content="9c4b809a854824ce">
		<meta name="google-site-verification" content="fkeFoEFB1NiuDjJcYRjHvaz8Od9jVb-RDZFrN4l0Dh4">
		<meta http-equiv="imagetoolbar" content="no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="meta-apple-mobile-web-app-status-bar-style" content="white">
		<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
		<meta name="author" content="Krasimir Tsonev">
		<meta name="copyright" content="Krasimir Tsonev">
		<meta name="robots" content="follow,index">
		<meta name="title" content="Dependency injection in JavaScript">
		<meta name="keywords" content="Dependency injection in JavaScript,  freelancer, front-end and back-end developer, web design, responsitive design, html, css, php, javascript, nodejs, photoshop, react, redux" lang="en-us">
		<meta name="description" content="I like the quote that the programming is all about managing complexity. Maybe you&#39;ve heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It&#39;s the same with JavaScript.  / blog of Krasimir Tsonev - front and back-end developer who writes for web">

		<meta property="og:type" content="article">
		<meta property="og:site_name" content="krasimirtsonev.com">
		<meta property="og:description" content="I like the quote that the programming is all about managing complexity. Maybe you&#39;ve heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It&#39;s the same with JavaScript. ">
		<meta property="fb:app_id" content="495371670514815">

		<meta name="twitter:card" content="I like the quote that the programming is all about managing complexity. Maybe you&#39;ve heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It&#39;s the same with JavaScript. ">
		<meta name="twitter:author" content="@KrasimirTsonev">
		<meta name="twitter:title" content="Dependency injection in JavaScript">
		<meta name="twitter:description" content="I like the quote that the programming is all about managing complexity. Maybe you&#39;ve heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It&#39;s the same with JavaScript. ">

		<link rel="icon" type="image/png" href="http://krasimirtsonev.com/main/pics/favicon.jpg">
     <meta property="og:title" content="Dependency injection in JavaScript"> <meta property="og:description" content="I like the quote that the programming is all about managing complexity. Maybe you&#39;ve heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It&#39;s the same with JavaScript. ">
		<title>Dependency injection in JavaScript</title>
		<link rel="stylesheet" href="./Dependency injection in JavaScript_files/styles.min.css">
		<link rel="author" href="https://plus.google.com/u/0/102456483730254999684">		
	<script id="twitter-wjs" src="./Dependency injection in JavaScript_files/widgets.js.download"></script><script async="" src="./Dependency injection in JavaScript_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Dependency injection in JavaScript_files/embed.js.download"></script><script id="_carbonads_projs" type="text/javascript" src="./Dependency injection in JavaScript_files/CKYIE2QI.json"></script><script charset="utf-8" src="./Dependency injection in JavaScript_files/button.dd024c345fc26f7c7a8d9938b67e5d3d.js.download"></script><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.9974049bf7b0591e5d4f055cb67f3ee3.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.880980e048a2432334f13013030456ac.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.7ca5005d1897180d07d928e89d2628be.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"><style></style></head>
<body class="ready"><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-left cc-color-override--810904148 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">This website uses cookies to ensure you get the best experience on our website. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://cookiesandyou.com/" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>

	<div class="content">
		<main class="content-left bb">
			<div class="author-card">
					<div class="cf">
							<img src="./Dependency injection in JavaScript_files/avatar_100x100.jpg" alt="author: Krasimir Tsonev" class="author-avatar">
							<p>
									<small>Krasimir is a <a href="http://krasimirtsonev.com/blog" title="blog of Krasimir Tsonev" target="_blank">blogger</a>, who <a href="http://krasimirtsonev.com/#publications" titles="publications of Krasimir Tsonev">writes</a> and <a href="http://krasimirtsonev.com/#talks" title="presentations by Krasimir Tsonev">speaks</a>.<br>He loves open source and codes awesome <a href="https://github.com/krasimir" title="open source projects by Krasimir Tsonev" target="_blank">stuff</a>.</small>
							</p>
							<p>
									<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 154px; height: 20px;" title="Twitter Follow Button" src="./Dependency injection in JavaScript_files/follow_button.2e9f365dae390394eb8d923cba8c5b11.en.html" data-screen-name="KrasimirTsonev"></iframe><script async="" src="./Dependency injection in JavaScript_files/widgets.js(1).download" charset="utf-8"></script>
							</p>
					</div>                    
			</div>
			<h1>Dependency injection in JavaScript</h1>
			<article>
                
                <div class="article-meta">/ <a href="http://krasimirtsonev.com/blog/">blog</a> / <a href="http://krasimirtsonev.com/blog/category/JavaScript" title="JavaScript">JavaScript</a></div><p>I like the quote that the programming is all about managing complexity. Maybe you've heard that the computer world is a giant construction of abstractions. We simply wrap things and produce new tools over and over again. Just think for a minute. The languages which you use have build-in functionalities and they are probably abstracted functions of other low level operations. It's the same with <a href="http://krasimirtsonev.com/blog/category/JavaScript">JavaScript</a>. Sooner or later you need to use abstractions made by other developers. I.e. you depend on someone's other code. I like the dependency-free modules, but that's kinda difficult to achieve. Even if you create those nice black-box liked components you still have a part which combines everything. That's where the dependency injection placed in. The ability to manage the dependencies effectively is absolutely necessary nowadays. This articles sums up my observations on the problem.</p>
<h2 id="the-goal">The goal</h2>
<p>Let's say that we have two modules. The first one is a service which makes Ajax requests and the second one is a router.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> service <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Service'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Router'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We have another function which needs these modules.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>And to make the things a little bit more interesting the function needs to accept one more parameter. Sure, we could use the above code, but that's not really flexible. What if we want to use <code>ServiceXML</code> or <code>ServiceJSON</code>. Or what if we want to mockup some of the modules for testing purposes. We can't just edit the body of the function. The first thing which we all come up with is to pass the dependencies as parameters to the function. I.e.:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> router<span class="token punctuation">,</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>By doing this we are passing the exact implementation of the module which we want. However this brings a new problem. Imagine if we have <code>doSomething</code> all over our code. What will happen if we need a third dependency. We can't edit all the function's calls. So, we need an instrument which will do that for us. That's what dependency injectors are trying to solve. Let's write down few goals which we want to achieve:</p>
<ul>
<li>we should be able to register dependencies</li>
<li>the injector should accept a function and should return a function which somehow gets the needed resources</li>
<li>we should not write a lot, we need short and nice syntax</li>
<li>the injector should keep the scope of the passed function</li>
<li>the passed function should be able to accept custom arguments, not only the described dependencies</li>
</ul>
<p>A nice list isn't it. Let's dive in.</p>
<h2 id="the-requirejs-amd-approach">The <a href="http://requirejs.org/">requirejs</a> / <a href="http://requirejs.org/docs/whyamd.html">AMD</a> approach</h2>
<p>You probably already know about <a href="http://requirejs.org/">requirejs</a>. It's a nice variant for solving dependencies.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token function">define<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> router<span class="token punctuation">)</span> <span class="token punctuation">{</span>       
    <span class="token comment" spellcheck="true">// ...
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The idea is firstly to describe the needed dependencies and then write your function. The order of the arguments is of course important here. Let's say that we will write a module called <code>injector</code> which will accept the same syntax.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">resolve<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> router<span class="token punctuation">,</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span>other<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Other'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething<span class="token punctuation">(</span></span><span class="token string">"Other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><i>Before to continue I should clarify the body of the <code>doSomething</code> function. I'm using <a href="https://github.com/LearnBoost/expect.js">expect.js</a> as a assertion library just to be sure that the code which I'm writing works as I want. A little bit TDD approach.</i></p>
<p>Here is what our <code>injector</code> module starts from. It's good to be a singleton, so it does its job from different parts of our application.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> injector <span class="token operator">=</span> <span class="token punctuation">{</span>
    dependencies<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    register<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    resolve<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>deps<span class="token punctuation">,</span> func<span class="token punctuation">,</span> scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Really simple object which has two functions and one variable which acts as a storage. What we have to do is to checks the <code>deps</code> array and search for answers in the <code>dependencies</code> variable. The rest is just calling the <code>.apply</code> method against the past <code>func</code> parameter.</p>
<pre class=" language-javascript"><code class=" language-javascript">resolve<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>deps<span class="token punctuation">,</span> func<span class="token punctuation">,</span> scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">,</span> d<span class="token operator">=</span>deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            args<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span><span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Can\'t resolve '</span> <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        func<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">(</span></span>scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat<span class="token punctuation">(</span></span>Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arguments<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>        
<span class="token punctuation">}</span>
</code></pre>
<p>If there is any scope it is effectively used. <code>Array.prototype.slice.call(arguments, 0)</code> is necessary to transform the <code>arguments</code> variable to an actually array. So far so good. Our test passes. The problem with this implementation is that we have to write the needed components twice and we can't really mix their order. The additional custom parameters are always after the dependencies.</p>
<h2 id="the-reflection-approach">The reflection approach</h2>
<p>According to Wikipedia <em>reflection</em> is the ability of a program to examine and modify the structure and behaviour of an object at runtime. With simple words, in the context of JavaScript, that's reading the source code of an object or function and analyzing it. Let's get our <code>doSomething</code> function from the beginning. If you log <code>doSomething.toString()</code> you will get the following string:</p>
<pre class=" language-javascript"><code class=" language-javascript">"<span class="token keyword">function</span> <span class="token punctuation">(</span>service<span class="token punctuation">,</span> router<span class="token punctuation">,</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>"
</code></pre>
<p>Having the method as a string gives us the ability to fetch the expected parameters. And, which is more important, their names. That's what <a href="http://angularjs.org/">Angular</a> uses for its dependency injection implementation. I cheated a bit and got the regular expression which exports the arguments directly from the Angular's code.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token regex">/^function\s*[^\(]*\(\s*([^\)]*)\)/m</span>
</code></pre>
<p>We could change the <code>resolve</code> class to the following:</p>
<pre class=" language-javascript"><code class=" language-javascript">resolve<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> func<span class="token punctuation">,</span> deps<span class="token punctuation">,</span> scope<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    func <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    deps <span class="token operator">=</span> func<span class="token punctuation">.</span><span class="token function">toString<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match<span class="token punctuation">(</span></span><span class="token regex">/^function\s*[^\(]*\(\s*([^\)]*)\)/m</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace<span class="token punctuation">(</span></span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">(</span></span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    scope <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> a <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arguments<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> d <span class="token operator">=</span> deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            args<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> d <span class="token operator">!</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token operator">?</span> self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token punctuation">:</span> a<span class="token punctuation">.</span><span class="token function">shift<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        func<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">(</span></span>scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>        
<span class="token punctuation">}</span>
</code></pre>
<p>We run the RegExp against the function's definition. The result is:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">[</span><span class="token string">"function (service, router, other)"</span><span class="token punctuation">,</span> <span class="token string">"service, router, other"</span><span class="token punctuation">]</span>
</code></pre>
<p>So, we need only the second item. Once we clean up the empty spaces and split the string we got the <code>deps</code> array filled. There is one more change:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arguments<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
args<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> d <span class="token operator">!</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token operator">?</span> self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token punctuation">:</span> a<span class="token punctuation">.</span><span class="token function">shift<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We are looping through the dependencies and if there is something missing we are trying to fetch it from the <code>arguments</code> object. Thankfully the <code>shift</code> method returns simply <code>undefined</code> if the array is empty. It's not throwing an error. The new version of the <code>injector</code> could be used like that:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">resolve<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> other<span class="token punctuation">,</span> router<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span>other<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Other'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething<span class="token punctuation">(</span></span><span class="token string">"Other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>No double writing of the dependencies and we could mix their order. It still works and we replicated the Angular's magic.</p>
<p>However, the world is not perfect and there is one very big problem with that reflection type of injection. The minification will break our logic. That's because it changes the names of the parameters and we will not be able to resolve the dependencies. For example:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>t<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> r<span class="token operator">=</span><span class="token function">e<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token function">t<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre>
<p>That's our <code>doSomething</code> function passed to a compressor. The solution proposed by Angular's team looks like that:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">resolve<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> router<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>It looks like the thing which we started with. I personally wasn't able to find a better solution, and decided to mix the two approaches. Here is the final version of the injector.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> injector <span class="token operator">=</span> <span class="token punctuation">{</span>
    dependencies<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    register<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    resolve<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> func<span class="token punctuation">,</span> deps<span class="token punctuation">,</span> scope<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            func <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            deps <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace<span class="token punctuation">(</span></span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">(</span></span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            scope <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            func <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            deps <span class="token operator">=</span> func<span class="token punctuation">.</span><span class="token function">toString<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match<span class="token punctuation">(</span></span><span class="token regex">/^function\s*[^\(]*\(\s*([^\)]*)\)/m</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace<span class="token punctuation">(</span></span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">(</span></span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            scope <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> a <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arguments<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> d <span class="token operator">=</span> deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                args<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> d <span class="token operator">!</span><span class="token operator">=</span> <span class="token string">''</span> <span class="token operator">?</span> self<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token punctuation">:</span> a<span class="token punctuation">.</span><span class="token function">shift<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            func<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">(</span></span>scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The <code>resolve</code> method accepts two or three parameters. If they are two it acts like we wrote it lately. However, if there are three arguments it gets the first one, parse it and fills the <code>deps</code> array. Here is the test case:</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">resolve<span class="token punctuation">(</span></span><span class="token string">'router,,service'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">a<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Other'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token function">c<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething<span class="token punctuation">(</span></span><span class="token string">"Other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>You will probably notice that there are two commas one after each other. That's not a typo. The empty value actually represents the <code>"Other"</code> parameter. That's how we will be able to control the order of the parameters.</p>
<h2 id="injection-directly-into-the-scope">Injection directly into the scope</h2>
<p>Sometimes I'm using a third variant of injection. It involves a manipulation of the function's scope (or with other words, the <code>this</code> object). So, it is not always appropriate.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> injector <span class="token operator">=</span> <span class="token punctuation">{</span>
    dependencies<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    register<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    resolve<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>deps<span class="token punctuation">,</span> func<span class="token punctuation">,</span> scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        scope <span class="token operator">=</span> scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">,</span> d<span class="token operator">=</span>deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                scope<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Can\'t resolve '</span> <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            func<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">(</span></span>scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arguments<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>All we do is to attach the dependencies to the scope. The benefits here are that the developer should not write the dependencies as parameters. They are just part of the function's scope.</p>
<pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> injector<span class="token punctuation">.</span><span class="token function">resolve<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">service<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">router<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect<span class="token punctuation">(</span></span>other<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">be<span class="token punctuation">(</span></span><span class="token string">'Other'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething<span class="token punctuation">(</span></span><span class="token string">"Other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="final-words">Final words</h2>
<p>The dependency injection is one of those things which we all do, but never think of. Even if you didn't hear about the term you probably use it million of times. </p>
<p>All the examples mentioned in this article could be seen <a href="https://github.com/krasimir/blog-posts/tree/master/JavaScriptDependencyInjection">here</a>.</p>
                
            </article>
                <a name="comments" title="comments"></a>
                <div class="disqus">
                    <div id="disqus_thread"><iframe id="dsq-app4148" name="dsq-app4148" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Dependency injection in JavaScript_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 6883px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
                    <script type="text/javascript">
                        var disqus_shortname = "blog-for-web-development";
                        var disqus_identifier = "Dependency-injection-in-JavaScript";
                        var disqus_url = "http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript";
                        (function() {
                            var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                            dsq.src = "http://" + disqus_shortname + ".disqus.com/embed.js";
                            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                    
                </div>
            <br class="clear">
			<footer>
		
				<div class="footer-block">
					<h4>Contact</h4>
					<p>
						email:<br>info (@) krasimirtsonev.com<br>
						<a href="http://krasimirtsonev.com/files/cv/" title="CV of Krasimir Tsonev" class="external"><i class="icon-file"></i> CV / Resume</a>
					</p>
				</div>
			
				<div class="footer-block">
					<h4>Nets</h4>
					<p>
						<a href="https://github.com/krasimir" title="GitHub" class="external"><i class="icon-check"></i> Check my account in GitHub</a><br>
						<a href="http://www.facebook.com/profile.php?id=617578836" title="Krasimir Tsonev on Facebook" class="external"><i class="icon-check"></i> Find me in Facebook</a><br>
						<a href="http://twitter.com/KrasimirTsonev" title="Krasimir Tsonev on Twitter" class="external"><i class="icon-check"></i> Follow me in Twitter</a><br>
						<a href="https://www.linkedin.com/in/krasimir-tsonev-67b8b66/" title="Krasimir Tsonev on Linked IN" class="external"><i class="icon-check"></i> Follow me in LinkedIn</a><br>
						<a href="http://www.freelancer.com/users/217240.html" title="Krasimir Tsonev on GetAFreelancer" class="external"><i class="icon-check"></i> My profile in Freelancer.com</a>
					</p>
				</div>
				
				<br class="clear">

			</footer>
		</main>
		<aside class="content-right bb">
			<div class="sidebar bb">
                <div class="newsletter-form">
                  <form action="http://krasimirtsonev.us12.list-manage.com/subscribe/post?u=765f9eb0c6abb87872ba30f87&amp;id=8db0568af1" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                    <p>Subscribe to my newsletter to get a carefully<br>curated list of web related topics.</p>
                    <input type="email" value="" name="EMAIL" class="required newsletter-email" placeholder="Your email">
                    <input type="submit" value="Subscribe" name="subscribe" class="newsletter-submit">
                    <p class="view-previous-campaigns">
                      <a href="http://us12.campaign-archive1.com/home/?u=765f9eb0c6abb87872ba30f87&amp;id=8db0568af1" title="View previous campaigns">View previous campaigns.</a>
                    </p>
                  </form>
                </div>
            <hr>
                    <div class="share-it">
                    <span>If you enjoy this post, share it!</span>
                    <a href="https://twitter.com/share?url=http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript&amp;text=Dependency+injection+in+JavaScript&amp;via=KrasimirTsonev" target="_blank" title="share in twitter"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="22" height="22" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM25.195 11.284c0.009 0.203 0.014 0.408 0.014 0.614 0 6.269-4.772 13.499-13.499 13.499-2.679 0-5.173-0.785-7.273-2.132 0.371 0.044 0.749 0.066 1.132 0.066 2.223 0 4.268-0.759 5.892-2.031-2.076-0.038-3.828-1.41-4.432-3.295 0.29 0.055 0.587 0.085 0.893 0.085 0.433 0 0.852-0.058 1.25-0.166-2.17-0.436-3.806-2.354-3.806-4.652 0-0.020 0-0.040 0-0.060 0.64 0.355 1.371 0.569 2.149 0.593-1.273-0.851-2.111-2.303-2.111-3.949 0-0.869 0.234-1.684 0.642-2.385 2.34 2.87 5.836 4.759 9.779 4.957-0.081-0.347-0.123-0.709-0.123-1.081 0-2.62 2.124-4.744 4.744-4.744 1.365 0 2.598 0.576 3.463 1.498 1.081-0.213 2.096-0.608 3.013-1.151-0.354 1.108-1.107 2.038-2.086 2.625 0.96-0.115 1.874-0.37 2.725-0.747-0.636 0.951-1.44 1.787-2.367 2.456z" fill="#55acee"></path></svg></a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript" target="_blank" title="share in facebook"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="22" height="22" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M16 0c8.837 0 16 7.163 16 16 0 8.159-6.107 14.892-14 15.876v-11.876h5.5l0.5-4h-6v-2c0-1.105 0.895-2 2-2h4v-4h-4c-3.314 0-6 2.686-6 6v2h-3v4h3v11.876c-7.893-0.984-14-7.717-14-15.876 0-8.837 7.163-16 16-16z" fill="#3b5998"></path></svg></a>
                    <a href="https://plus.google.com/share?url=http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript" target="_blank" title="share in google+"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="22" height="22" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M13.656 25.568c0 2.346-1.45 4.2-5.555 4.349-2.406-1.368-4.422-3.342-5.841-5.715 0.74-1.828 3.053-3.22 5.697-3.191 0.751 0.008 1.45 0.129 2.086 0.334 1.747 1.215 3.156 1.974 3.51 3.358 0.066 0.28 0.103 0.569 0.103 0.864zM16 0c-4.623 0-8.787 1.962-11.708 5.097 1.154-0.639 2.517-1.020 3.966-1.020 2.096 0 8.014 0 8.014 0l-1.791 1.879h-2.103c1.484 0.85 2.274 2.601 2.274 4.532 0 1.772-0.982 3.199-2.368 4.283-1.352 1.056-1.609 1.499-1.609 2.398 0 0.767 1.616 1.909 2.359 2.467 2.588 1.941 3.112 3.162 3.112 5.59 0 2.46-2.154 4.91-5.808 5.742 1.761 0.667 3.67 1.033 5.664 1.033 8.837 0 16-7.163 16-16s-7.163-16-16-16zM24 12v4h-2v-4h-4v-2h4v-4h2v4h4v2h-4zM11.43 10.608c0.373 2.837-0.87 4.662-3.029 4.598-2.16-0.065-4.213-2.047-4.586-4.883-0.373-2.837 1.076-5.008 3.235-4.944s4.007 2.392 4.379 5.228zM6.903 20.065c-2.334 0-4.316 0.805-5.714 1.996-0.766-1.869-1.189-3.915-1.189-6.060 0-1.774 0.289-3.48 0.822-5.075 0.23 3.108 2.417 5.506 6.030 5.506 0.266 0 0.524-0.014 0.777-0.032-0.248 0.476-0.426 1.006-0.426 1.562 0 0.937 0.515 1.471 1.152 2.090-0.481 0-0.946 0.013-1.454 0.013z" fill="#dc4e41"></path></svg></a>
                    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://krasimirtsonev.com/blog/article/Dependency-injection-in-JavaScript" target="_blank" title="share in linkedin"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="22" height="22" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M26.625 0h-21.25c-2.956 0-5.375 2.419-5.375 5.375v21.25c0 2.956 2.419 5.375 5.375 5.375h21.25c2.956 0 5.375-2.419 5.375-5.375v-21.25c0-2.956-2.419-5.375-5.375-5.375zM12 26h-4v-14h4v14zM10 10c-1.105 0-2-0.895-2-2s0.895-2 2-2 2 0.895 2 2-0.895 2-2 2zM26 26h-4v-8c0-1.105-0.895-2-2-2s-2 0.895-2 2v8h-4v-14h4v2.483c0.825-1.133 2.086-2.483 3.5-2.483 2.485 0 4.5 2.239 4.5 5v9z" fill="#0077b5"></path></svg></a>
                    </div>
            <hr>
                <script async="" type="text/javascript" src="./Dependency injection in JavaScript_files/carbon.js.download" id="_carbonads_js"></script><div id="carbonads"><span><span class="carbon-wrap"><a href="https://srv.carbonads.net/ads/click/x/GTND42QMC6AIK2JMCAALYKQMCWYILKQYCEBDLZ3JCWBI6KQIF6BDT5QKC6BIPKQ7FTYIKK3EHJNCLSIZ?segment=placement:krasimirtsonevcom;" class="carbon-img" target="_blank" rel="noopener"><img src="./Dependency injection in JavaScript_files/1550855391-cc_dark.png" alt="" border="0" height="100" width="130" style="max-width: 130px;"></a><a href="https://srv.carbonads.net/ads/click/x/GTND42QMC6AIK2JMCAALYKQMCWYILKQYCEBDLZ3JCWBI6KQIF6BDT5QKC6BIPKQ7FTYIKK3EHJNCLSIZ?segment=placement:krasimirtsonevcom;" class="carbon-text" target="_blank" rel="noopener">Adobe Creative Cloud for Teams starting at $29.99 per month.</a></span><a href="http://carbonads.net/?utm_source=krasimirtsonevcom&amp;utm_medium=ad_via_link&amp;utm_campaign=in_unit&amp;utm_term=carbon" class="carbon-poweredby" target="_blank" rel="noopener">ads via Carbon</a></span></div>
            <hr>Similar posts:<ul class="similar-posts"><li><a href="http://krasimirtsonev.com/blog/article/build-your-own-interactive-javascript-playground" title="Build your own interactive JavaScript playground"><span class="star"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z" fill="#6BBF6E"></path></svg></span>Build your own interactive JavaScript playground</a></li><li><a href="http://krasimirtsonev.com/blog/article/my-new-and-shiny-too-for-live-demos-demoit" title="My new and shiny tool for live demos - Demoit"><span class="star"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z" fill="#6BBF6E"></path></svg></span>My new and shiny tool for live demos - Demoit</a></li><li><a href="http://krasimirtsonev.com/blog/article/react-hooks-changing-the-mindset" title="React hooks: changing the mindset"><span class="star"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z" fill="#6BBF6E"></path></svg></span>React hooks: changing the mindset</a></li><li><a href="http://krasimirtsonev.com/blog/article/pixo-image-editor-for-your-web-app" title="Pixo - Image editor for your web app"><span class="star"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z" fill="#6BBF6E"></path></svg></span>Pixo - Image editor for your web app</a></li><li><a href="http://krasimirtsonev.com/blog/article/story-about-react-redux-server-side-rendering-ssr" title="A story about React, Redux and server-side rendering"><span class="star"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 32 32"><g id="icomoon-ignore"><line stroke-width="1" x1="" y1="" x2="" y2="" stroke="#449FDB" opacity=""></line></g><path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z" fill="#6BBF6E"></path></svg></span>A story about React, Redux and server-side rendering</a></li></ul><hr>My <em>rockstar</em> projects:<ul class="similar-posts"><li><a href="https://github.com/krasimir/react-in-patterns"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>React in patterns</a></li><li><a href="https://github.com/krasimir/navigo"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>Navigo</a> - client-side router</li><li><a href="https://github.com/krasimir/cssx"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>CSSX</a> - CSS transpiler</li><li><a href="https://github.com/krasimir/stent"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>Stent</a> - state machines to the rescue</li><li><a href="https://github.com/krasimir/deb.js"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>Deb.js</a> - library for debugging in the browser</li><li><a href="https://github.com/krasimir/absurd"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>Absurd.js</a> - a JavaScript library with superpowers</li><li><a href="https://github.com/krasimir/kuker"><span class="star"><svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M681 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"></path></svg></span>Kuker</a> - browser extension to debug modern apps</li></ul><hr>
                Get updates for my newest articles or projects by following me on <a href="https://twitter.com/KrasimirTsonev" target="_blank">Twitter</a> or <a href="https://github.com/krasimir" target="_blank">GitHub</a>
            </div>
		</aside>
	</div>

	<div class="image"></div>

	<script src="./Dependency injection in JavaScript_files/scripts.js.download" async="" defer=""></script>
	
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-1621908-1', 'auto');
	  ga('send', 'pageview');

	</script>

	<link rel="stylesheet" type="text/css" href="./Dependency injection in JavaScript_files/cookieconsent.min.css">
    <script src="./Dependency injection in JavaScript_files/cookieconsent.min.js.download"></script>
    <script>
    window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#edeff5",
          "text": "#838391"
        },
        "button": {
          "background": "#8a8a8a"
        }
      },
      "theme": "classic",
      "position": "bottom-left"
    })});
    </script>


<iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Dependency injection in JavaScript_files/widget_iframe.2e9f365dae390394eb8d923cba8c5b11.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe style="display: none;" src="./Dependency injection in JavaScript_files/saved_resource(1).html"></iframe></body></html>